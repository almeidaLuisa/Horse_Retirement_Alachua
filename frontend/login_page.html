<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Login â€” Horse Retirement Alachua</title>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
		<style>
			:root {
				--primary-green: #9CD479;
				--primary-blue: #79AED4;
				--dark-bg: #f8f9fa;
				--light-text: #333;
			}
			
			body {
				background: linear-gradient(135deg, var(--primary-green) 0%, var(--primary-blue) 100%);
				min-height: 100vh;
				display: flex;
				align-items: center;
				font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			}
			
			.login-container {
				max-width: 450px;
				width: 100%;
				margin: auto;
			}
			
			.card {
				border: none;
				border-radius: 15px;
				box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
				overflow: hidden;
			}
			
			.card-header {
				background: linear-gradient(135deg, var(--primary-green) 0%, var(--primary-blue) 100%);
				color: white;
				padding: 2rem;
				text-align: center;
			}
			
			.card-header h1 {
				font-size: 2rem;
				margin: 0;
				font-weight: 700;
			}
			
			.card-header p {
				margin: 0.5rem 0 0 0;
				opacity: 0.9;
				font-size: 0.95rem;
			}
			
			.btn-primary {
				background-color: var(--primary-blue);
				border-color: var(--primary-blue);
				color: white;
				font-weight: 600;
				padding: 0.75rem;
				border-radius: 8px;
				transition: all 0.3s ease;
			}
			
			.btn-primary:hover {
				background-color: #6da0c4;
				border-color: #6da0c4;
				transform: translateY(-2px);
				box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
			}
			
			.btn-outline-secondary {
				color: var(--primary-blue);
				border-color: var(--primary-blue);
				border-radius: 8px;
				font-weight: 600;
			}
			
			.btn-outline-secondary:hover {
				background-color: var(--primary-blue);
				border-color: var(--primary-blue);
				color: white;
			}
			
			.form-label {
				font-weight: 600;
				color: var(--light-text);
				margin-bottom: 0.5rem;
			}
			
			.form-control {
				border: 2px solid #e0e0e0;
				border-radius: 8px;
				padding: 0.75rem 1rem;
				transition: border-color 0.3s ease;
			}
			
			.form-control:focus {
				border-color: var(--primary-blue);
				box-shadow: 0 0 0 0.2rem rgba(121, 174, 212, 0.25);
			}
			
			.text-danger {
				background-color: #ffe6e6;
				padding: 0.75rem;
				border-radius: 8px;
				border-left: 4px solid #dc3545;
			}
			
			.auth-link {
				color: var(--primary-blue);
				text-decoration: none;
				font-weight: 600;
				transition: color 0.3s ease;
			}
			
			.auth-link:hover {
				color: #6da0c4;
				text-decoration: underline;
			}
			
			.logo-section {
				text-align: center;
				margin-bottom: 1.5rem;
			}
			
			.logo-section i {
				font-size: 3rem;
				color: var(--primary-green);
				margin-bottom: 0.5rem;
			}
		</style>
	</head>
	<body>
		<div class="login-container">
			<div class="card">
				<div class="card-header">
					<h1><i class="fas fa-horse"></i> RHHF</h1>
					<p>Retirement Home for Horses Management</p>
				</div>
				<div class="card-body p-4">
					<div class="logo-section">
						<i class="fas fa-sign-in-alt"></i>
					</div>
					
					<h5 class="text-center mb-4">Log In to Your Account</h5>

					<form id="loginForm">
						<div class="mb-3">
							<label for="email" class="form-label">Email Address</label>
							<input class="form-control" id="email" type="email" autocomplete="email" placeholder="Enter your email" required />
						</div>
						<div class="mb-3">
							<label for="password" class="form-label">Password</label>
							<input class="form-control" id="password" type="password" autocomplete="current-password" placeholder="Enter your password" required />
						</div>

						<div class="text-danger small mb-3" id="loginError" style="display:none;"></div>

						<div class="d-grid gap-2">
							<button class="btn btn-primary" type="submit" id="loginBtn">
								<i class="fas fa-sign-in-alt"></i> Login
							</button>
						</div>
					</form>

					<hr class="my-4" />
					
					<div class="text-center">
						<p class="text-muted mb-3">Don't have an account yet?</p>
						<a class="btn btn-outline-secondary w-100" href="register_page.html">
							<i class="fas fa-user-plus"></i> Create Account
						</a>
					</div>

					<div class="text-center mt-4">
						<a href="home_page.html" class="auth-link">
							<i class="fas fa-arrow-left"></i> Back to Home
						</a>
					</div>
				</div>
			</div>
		</div>

		<script>
			(function () {
				const form = document.getElementById('loginForm');
				const errorEl = document.getElementById('loginError');
				const loginBtn = document.getElementById('loginBtn');

				function setError(msg) {
					if (!msg) {
						errorEl.style.display = 'none';
						errorEl.textContent = '';
						return;
					}
					errorEl.style.display = 'block';
					errorEl.textContent = msg;
				}

				form.addEventListener('submit', async (e) => {
					e.preventDefault();
					setError('');
					loginBtn.disabled = true;
					loginBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Logging in...';

					const email = document.getElementById('email').value.trim();
					const password = document.getElementById('password').value;

					try {
						const res = await fetch('/api/auth/login', {
							method: 'POST',
							headers: { 'Content-Type': 'application/json' },
							body: JSON.stringify({ email, password })
						});

						const data = await res.json().catch(() => ({}));
						if (!res.ok) {
							setError(data?.error || 'Login failed.');
							loginBtn.disabled = false;
							loginBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Login';
							return;
						}

						localStorage.setItem('authToken', data.token);
						localStorage.setItem('user', JSON.stringify(data.user));
						window.location.href = 'dashboard_page.html';
					} catch (err) {
						setError('Network error. Is the server running?');
						loginBtn.disabled = false;
						loginBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Login';
					}
				});
			})();
		</script>
	</body>
</html>